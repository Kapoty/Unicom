"use strict";(self.webpackChunkunicom=self.webpackChunkunicom||[]).push([[648],{4648:(e,t,r)=>{r.r(t),r.d(t,{default:()=>k});var o=r(7294),n=r(3906),i=r(4680),a=r(1311),l=r(2658),u=r(2642),c=r(6585),s=r(461),f=r(9708),m=r(1715),d=r(7957),p=r(6867),h=r(7280),v=r(5398),y=r(4563),b=r(2288),g=r(2981),w=r(7109),E=r(310),S=r(9250);function O(e){return O="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},O(e)}function Z(){return Z=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(e[o]=r[o])}return e},Z.apply(this,arguments)}function A(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,(void 0,n=function(e,t){if("object"!==O(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,"string");if("object"!==O(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(o.key),"symbol"===O(n)?n:String(n)),o)}var n}function U(e,t){return U=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},U(e,t)}function x(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function C(e){return C=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},C(e)}var P=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&U(e,t)}(k,e);var t,r,S,Z,P=(S=k,Z=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=C(S);if(Z){var r=C(this).constructor;e=Reflect.construct(t,arguments,r)}else e=t.apply(this,arguments);return function(e,t){if(t&&("object"===O(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return x(e)}(this,e)});function k(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,k),(t=P.call(this,e)).state={usuarioList:null,usuarioRows:[],usuarioSelected:null,calling:!1,alertOpen:!1,alert:null},t.columns=[{field:"fotoPerfil",headerName:"",renderCell:function(e){return o.createElement(w.Z,{src:e.row.fotoPerfilUrl},e.row.nome.charAt(0))}},{field:"nome",headerName:"Nome",minWidth:200,flex:1},{field:"matricula",headerName:"Matrícula",minWidth:200,flex:1},{field:"email",headerName:"Email",minWidth:200,flex:1},{field:"departamento",headerName:"Departamento",minWidth:200,flex:1},{field:"cargo",headerName:"Cargo",minWidth:200,flex:1},{field:"papelList",headerName:"Papéis",minWidth:300,flex:1,renderCell:function(e){return o.createElement(f.Z,{direction:"row",spacing:1,sx:{overflow:"auto"}},e.value.map((function(e){return o.createElement(s.Z,{key:e,label:e,variant:"outlined"})})))}},{field:"ativo",headerName:"Status",width:100,renderCell:function(e){return o.createElement(s.Z,{label:e.value?"Ativo":"Inativo",color:e.value?"success":"error"})}},{field:"actions",headerName:"Ações",width:300,renderCell:function(e){return o.createElement(f.Z,{direction:"row",spacing:1},o.createElement(y.Z,{title:"Editar",onClick:function(){return t.props.navigate("/usuarios/"+e.row.usuarioId)}},o.createElement(p.Z,{color:"warning"},o.createElement(d.Z,null))),e.row.ativo?o.createElement(y.Z,{title:"Desativar"},o.createElement("span",null,o.createElement(p.Z,{color:"error",onClick:function(){return t.setUsuarioAtivo(e.row.usuarioId,!e.row.ativo)},disabled:e.row.usuarioId==t.props.usuario.usuarioId},o.createElement(h.Z,null)))):o.createElement(y.Z,{title:"Ativar",onClick:function(){return t.setUsuarioAtivo(e.row.usuarioId,!e.row.ativo)}},o.createElement(p.Z,{color:"success"},o.createElement(v.Z,null))))}}],t.getUsuarioListFromApi=t.getUsuarioListFromApi.bind(x(t)),t.handleUsuarioSelected=t.handleUsuarioSelected.bind(x(t)),t.setUsuarioAtivo=t.setUsuarioAtivo.bind(x(t)),t.openAlert=t.openAlert.bind(x(t)),t.closeAlert=t.closeAlert.bind(x(t)),t}return t=k,(r=[{key:"componentDidMount",value:function(){this.getUsuarioListFromApi()}},{key:"getUsuarioListFromApi",value:function(){var e=this;this.setState({calling:!0}),E.Z.get("/empresa/me/usuario").then((function(t){var r=t.data.map((function(e){return{id:e.usuarioId,fotoPerfilUrl:e.fotoPerfil?E.Z.defaults.baseURL+"/usuario/"+e.usuarioId+"/foto-perfil?versao="+e.fotoPerfilVersao:"",usuarioId:e.usuarioId,nome:e.nome,matricula:e.matricula,email:e.email,papelList:e.papelList.map((function(e){return e.nome})),departamento:null!==e.departamento?e.departamento.nome:"",cargo:null!==e.cargo?e.cargo.nome:"",ativo:e.ativo}}));e.setState({usuarioList:t.data,usuarioRows:r,calling:!1})})).catch((function(t){console.log(t),setTimeout(e.getUsuarioListFromApi,3e3)}))}},{key:"handleUsuarioSelected",value:function(e){var t=null;e.length>0&&(t=this.state.usuarioList.filter((function(t){return t.usuarioId==e[0]}))[0]),this.setState({usuarioSelected:t})}},{key:"openAlert",value:function(e,t){this.setState({alert:o.createElement(b.Z,{severity:e,onClose:this.closeAlert},t),alertOpen:!0})}},{key:"closeAlert",value:function(){this.setState({alertOpen:!1})}},{key:"setUsuarioAtivo",value:function(e,t){var r=this;E.Z.patch("/usuario/".concat(e),{ativo:t}).then((function(o){r.openAlert("success","Usuário ".concat(e," ").concat(t?"ativado":"desativado"," com sucesso!")),r.getUsuarioListFromApi()})).catch((function(e){r.openAlert("error","Falha ao ".concat(t?"ativar":"desativar"," usuário!"))})).finally((function(){r.setState({calling:!1})}))}},{key:"render",value:function(){var e=this;return o.createElement(o.Fragment,null,o.createElement(i.Z,{elevation:3,sx:{flexGrow:1,padding:5,minHeight:"100%",minWidth:"800px",boxSizing:"border-box",display:"flex",flexDirection:"column",aligmItems:"center",justifyContent:"start"},className:"modulePaper"},o.createElement(l.Z,{variant:"h3",gutterBottom:!0},"Usuários"),o.createElement(c.Z,{sx:{marginBottom:3}},o.createElement(u.Z,{variant:"contained",size:"large",startIcon:o.createElement(m.Z,null),onClick:function(){return e.props.navigate("/usuarios/novo")}},"Novo Usuário")),o.createElement(n.Z,{sx:{flexGrow:1}},o.createElement(a._$,{rows:this.state.usuarioRows,columns:this.columns,disableColumnFilter:!0,disableColumnMenu:!0,disableColumnSelector:!0,disableRowSelectionOnClick:!0,autoHeight:!0,initialState:{pagination:{paginationModel:{pageSize:10}}},pageSizeOptions:[10,30,50,100],onRowSelectionModelChange:this.handleUsuarioSelected,loading:null==this.state.usuarioList||this.state.calling,sx:{marginBottom:3}})),o.createElement(g.Z,{in:this.state.alertOpen},this.state.alert)))}}])&&A(t.prototype,r),Object.defineProperty(t,"prototype",{writable:!1}),k}(o.Component);const k=function(e){var t=(0,S.UO)(),r=(0,S.TH)(),n=(0,S.s0)();return o.createElement(P,Z({params:t,location:r,navigate:n},e))}}}]);