"use strict";(self.webpackChunkunicom=self.webpackChunkunicom||[]).push([[396],{610:(t,e,o)=>{var n=o(4836);e.Z=void 0;var r=n(o(4938)),i=o(5893),a=(0,r.default)((0,i.jsx)("path",{d:"M17.81 4.47c-.08 0-.16-.02-.23-.06C15.66 3.42 14 3 12.01 3c-1.98 0-3.86.47-5.57 1.41-.24.13-.54.04-.68-.2-.13-.24-.04-.55.2-.68C7.82 2.52 9.86 2 12.01 2c2.13 0 3.99.47 6.03 1.52.25.13.34.43.21.67-.09.18-.26.28-.44.28zM3.5 9.72c-.1 0-.2-.03-.29-.09-.23-.16-.28-.47-.12-.7.99-1.4 2.25-2.5 3.75-3.27C9.98 4.04 14 4.03 17.15 5.65c1.5.77 2.76 1.86 3.75 3.25.16.22.11.54-.12.7-.23.16-.54.11-.7-.12-.9-1.26-2.04-2.25-3.39-2.94-2.87-1.47-6.54-1.47-9.4.01-1.36.7-2.5 1.7-3.4 2.96-.08.14-.23.21-.39.21zm6.25 12.07c-.13 0-.26-.05-.35-.15-.87-.87-1.34-1.43-2.01-2.64-.69-1.23-1.05-2.73-1.05-4.34 0-2.97 2.54-5.39 5.66-5.39s5.66 2.42 5.66 5.39c0 .28-.22.5-.5.5s-.5-.22-.5-.5c0-2.42-2.09-4.39-4.66-4.39-2.57 0-4.66 1.97-4.66 4.39 0 1.44.32 2.77.93 3.85.64 1.15 1.08 1.64 1.85 2.42.19.2.19.51 0 .71-.11.1-.24.15-.37.15zm7.17-1.85c-1.19 0-2.24-.3-3.1-.89-1.49-1.01-2.38-2.65-2.38-4.39 0-.28.22-.5.5-.5s.5.22.5.5c0 1.41.72 2.74 1.94 3.56.71.48 1.54.71 2.54.71.24 0 .64-.03 1.04-.1.27-.05.53.13.58.41.05.27-.13.53-.41.58-.57.11-1.07.12-1.21.12zM14.91 22c-.04 0-.09-.01-.13-.02-1.59-.44-2.63-1.03-3.72-2.1-1.4-1.39-2.17-3.24-2.17-5.22 0-1.62 1.38-2.94 3.08-2.94 1.7 0 3.08 1.32 3.08 2.94 0 1.07.93 1.94 2.08 1.94s2.08-.87 2.08-1.94c0-3.77-3.25-6.83-7.25-6.83-2.84 0-5.44 1.58-6.61 4.03-.39.81-.59 1.76-.59 2.8 0 .78.07 2.01.67 3.61.1.26-.03.55-.29.64-.26.1-.55-.04-.64-.29-.49-1.31-.73-2.61-.73-3.96 0-1.2.23-2.29.68-3.24 1.33-2.79 4.28-4.6 7.51-4.6 4.55 0 8.25 3.51 8.25 7.83 0 1.62-1.38 2.94-3.08 2.94s-3.08-1.32-3.08-2.94c0-1.07-.93-1.94-2.08-1.94s-2.08.87-2.08 1.94c0 1.71.66 3.31 1.87 4.51.95.94 1.86 1.46 3.27 1.85.27.07.42.35.35.61-.05.23-.26.38-.47.38z"}),"Fingerprint");e.Z=a},3595:(t,e,o)=>{var n=o(4836);e.Z=void 0;var r=n(o(4938)),i=o(5893),a=(0,r.default)((0,i.jsx)("path",{d:"M18 8h-1V6c0-2.76-2.24-5-5-5S7 3.24 7 6v2H6c-1.1 0-2 .9-2 2v10c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V10c0-1.1-.9-2-2-2zm-6 9c-1.1 0-2-.9-2-2s.9-2 2-2 2 .9 2 2-.9 2-2 2zm3.1-9H8.9V6c0-1.71 1.39-3.1 3.1-3.1 1.71 0 3.1 1.39 3.1 3.1v2z"}),"Lock");e.Z=a},7412:(t,e,o)=>{var n=o(4836);e.Z=void 0;var r=n(o(4938)),i=o(5893),a=(0,r.default)((0,i.jsx)("path",{d:"M12 17c1.1 0 2-.9 2-2s-.9-2-2-2-2 .9-2 2 .9 2 2 2zm6-9h-1V6c0-2.76-2.24-5-5-5S7 3.24 7 6h1.9c0-1.71 1.39-3.1 3.1-3.1 1.71 0 3.1 1.39 3.1 3.1v2H6c-1.1 0-2 .9-2 2v10c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V10c0-1.1-.9-2-2-2zm0 12H6V10h12v10z"}),"LockOpen");e.Z=a},9396:(t,e,o)=>{o.r(e),o.d(e,{default:()=>F});var n=o(7294),r=o(3906),i=o(4680),a=o(2658),s=o(2288),c=o(2981),l=o(9062),u=o(558),d=o(9708),h=o(3516),g=o(3486);const m="#ffee58",p="#fbc02d";var f=o(6949),v=o(265),y=o(610),P=o(3595),Z=o(7412),b=o(4563),S=o(7638),E=o(310),k=o(9250);function A(t){return A="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},A(t)}function j(){return j=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var o=arguments[e];for(var n in o)Object.prototype.hasOwnProperty.call(o,n)&&(t[n]=o[n])}return t},j.apply(this,arguments)}function x(t,e){for(var o=0;o<e.length;o++){var n=e[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(void 0,r=function(t,e){if("object"!==A(t)||null===t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,"string");if("object"!==A(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(n.key),"symbol"===A(r)?r:String(r)),n)}var r}function O(t,e){return O=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},O(t,e)}function R(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function w(t){return w=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},w(t)}var z=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&O(t,e)}(F,t);var e,o,k,j,z=(k=F,j=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=w(k);if(j){var o=w(this).constructor;t=Reflect.construct(e,arguments,o)}else t=e.apply(this,arguments);return function(t,e){if(e&&("object"===A(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return R(t)}(this,t)});function F(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,F),(e=z.call(this,t)).state={isAuth:(0,S.$D)(),registroPonto:null,naoRegistraReason:null,lockedSeconds:null,color:"primary",calling:!1,logging:!1,authenticating:!1,alertOpen:!1,alert:null},e.getUsuarioRegistroPontoFromApi=e.getUsuarioRegistroPontoFromApi.bind(R(e)),e.registrarPonto=e.registrarPonto.bind(R(e)),e.getLockedSecondsFromApi=e.getLockedSecondsFromApi.bind(R(e)),e.handleAuthenticate=e.handleAuthenticate.bind(R(e)),e.authenticate=e.authenticate.bind(R(e)),e.validateToken=e.validateToken.bind(R(e)),e.minusOneSecond=e.minusOneSecond.bind(R(e)),e.openAlert=e.openAlert.bind(R(e)),e.closeAlert=e.closeAlert.bind(R(e)),e}return e=F,(o=[{key:"componentDidMount",value:function(){this.getUsuarioRegistroPontoFromApi(),this.state.isAuth&&this.validateToken()}},{key:"getUsuarioRegistroPontoFromApi",value:function(){var t=this;this.setState({calling:!0,naoRegistraReason:null,lockedSeconds:null}),E.Z.get("/registro-ponto/me/hoje").then((function(e){var o=e.data,n=null,r="primary";null==o.entrada?r="success":null==o.intervaloInicio?r="warning":null==o.intervaloFim?r="info":null==o.saida?r="error":n="Dia registrado com sucesso!",t.setState({registroPonto:o,color:r,naoRegistraReason:n,calling:!1}),t.getLockedSecondsFromApi()})).catch((function(e){var o={},n=null;"response"in e&&"errors"in e.response.data?n="contrato"in(o=e.response.data.errors)?"Usuário sem contrato cadastrado!":"jornada"in o?"Usuário sem jornada cadastrada!":"hoje"in o?"Usuário não registra ponto hoje!":"Falha inesperada!":(n="O servidor não respondeu a solicitação!",setTimeout(t.getUsuarioRegistroPontoFromApi,3e3)),t.setState({calling:!1,naoRegistraReason:n})}))}},{key:"registrarPonto",value:function(){var t=this;this.setState({calling:!0,logging:!0}),E.Z.post("/registro-ponto/me/hoje/registrar",{token:(0,S.LP)()}).then((function(e){t.setState({calling:!1,logging:!1}),t.openAlert("success","Ponto registrado com sucesso!"),t.getUsuarioRegistroPontoFromApi()})).catch((function(e){var o={};"response"in e&&"errors"in e.response.data?"full"in(o=e.response.data.errors)?t.openAlert("error","Todos os pontos já foram batidos hoje!"):"locked"in o?t.openAlert("error","Por favor, aguarde os segundos restantes..."):"token"in o?t.openAlert("error","Dispositivo não autorizado!"):t.openAlert("error","Erro inesperado!"):t.openAlert("error","Falha ao registrar ponto!"),t.setState({calling:!1,logging:!1}),t.getUsuarioRegistroPontoFromApi()}))}},{key:"getLockedSecondsFromApi",value:function(){var t=this;this.setState({lockedSeconds:null}),E.Z.get("/registro-ponto/me/hoje/locked-seconds").then((function(e){t.setState({lockedSeconds:e.data.lockedSeconds},(function(){return setTimeout(t.minusOneSecond,1e3)}))})).catch((function(e){console.log(e),setTimeout(t.getLockedSecondsFromApi,3e3)}))}},{key:"minusOneSecond",value:function(){var t=this.state.lockedSeconds;t>0&&(0!=(t-=1)&&setTimeout(this.minusOneSecond,1e3),this.setState({lockedSeconds:t}))}},{key:"openAlert",value:function(t,e){this.setState({alert:n.createElement(s.Z,{severity:t,onClose:this.closeAlert},e),alertOpen:!0})}},{key:"closeAlert",value:function(){this.setState({alertOpen:!1})}},{key:"handleAuthenticate",value:function(){this.state.isAuth?(this.openAlert("success","Dispositivo desautorizado com sucesso!"),(0,S.gy)(),this.setState({isAuth:!1})):this.authenticate()}},{key:"authenticate",value:function(){var t=this;this.setState({authenticating:!0}),E.Z.get("/registro-ponto/generate-token").then((function(e){t.openAlert("success","Dispositivo autorizado com sucesso!"),(0,S.o4)(e.data.token),t.setState({authenticating:!1,isAuth:!0})})).catch((function(e){console.log(e),t.openAlert("error","Falha ao autorizar dispositivo!"),t.setState({authenticating:!1})}))}},{key:"validateToken",value:function(){var t=this;E.Z.post("/registro-ponto/validate-token",{token:(0,S.LP)()}).then((function(e){t.setState({isAuth:!0})})).catch((function(e){t.openAlert("error","Autorização do dispositivo expirou!"),(0,S.gy)(),t.setState({isAuth:!1})}))}},{key:"render",value:function(){return n.createElement(n.Fragment,null,n.createElement(i.Z,{elevation:3,sx:{flexGrow:1,padding:5,minHeight:"100%",minWidth:"900px",boxSizing:"border-box",display:"flex",flexDirection:"column",aligmItems:"center",justifyContent:"start"},className:"modulePaper"},n.createElement(r.Z,{sx:{flexGrow:1}},n.createElement(u.ZP,{container:!0,spacing:3,sx:{margin:0}},n.createElement(u.ZP,{item:!0,xs:3},n.createElement(d.Z,{alignItems:"center"},n.createElement(b.Z,{title:"Horário do Registro"},n.createElement(a.Z,{variant:"h4",sx:{fontWeight:"bold"},gutterBottom:!0,color:g.Z[400]},null!==this.state.registroPonto&&null!==this.state.registroPonto.entrada?this.state.registroPonto.entrada:"-")),n.createElement(a.Z,{variant:"h6"},"Entrada"),n.createElement(b.Z,{title:"Jornada Padrão"},n.createElement(a.Z,{variant:"h6",color:g.Z[700]},null!==this.state.registroPonto?this.state.registroPonto.jornadaEntrada:"-")))),n.createElement(u.ZP,{item:!0,xs:3},n.createElement(d.Z,{alignItems:"center"},n.createElement(b.Z,{title:"Horário do Registro"},n.createElement(a.Z,{variant:"h4",sx:{fontWeight:"bold"},gutterBottom:!0,color:m},null!==this.state.registroPonto&&null!==this.state.registroPonto.intervaloInicio?this.state.registroPonto.intervaloInicio:"-")),n.createElement(a.Z,{variant:"h6"},"Início do Intervalo"),n.createElement(b.Z,{title:"Jornada Padrão"},n.createElement(a.Z,{variant:"h6",color:p},null!==this.state.registroPonto?this.state.registroPonto.jornadaIntervaloInicio:"-")))),n.createElement(u.ZP,{item:!0,xs:3},n.createElement(d.Z,{alignItems:"center"},n.createElement(b.Z,{title:"Horário do Registro"},n.createElement(a.Z,{variant:"h4",sx:{fontWeight:"bold"},gutterBottom:!0,color:f.Z[400]},null!==this.state.registroPonto&&null!==this.state.registroPonto.intervaloFim?this.state.registroPonto.intervaloFim:"-")),n.createElement(a.Z,{variant:"h6"},"Fim do Intervalo"),n.createElement(b.Z,{title:"Jornada Padrão"},n.createElement(a.Z,{variant:"h6",color:f.Z[700]},null!==this.state.registroPonto?this.state.registroPonto.jornadaIntervaloFim:"-")))),n.createElement(u.ZP,{item:!0,xs:3},n.createElement(d.Z,{alignItems:"center"},n.createElement(b.Z,{title:"Horário do Registro"},n.createElement(a.Z,{variant:"h4",sx:{fontWeight:"bold"},gutterBottom:!0,color:v.Z[400]},null!==this.state.registroPonto&&null!==this.state.registroPonto.saida?this.state.registroPonto.saida:"-")),n.createElement(a.Z,{variant:"h6"},"Saída"),n.createElement(b.Z,{title:"Jornada Padrão"},n.createElement(a.Z,{variant:"h6",color:v.Z[700]},null!==this.state.registroPonto?this.state.registroPonto.jornadaSaida:"-")))),n.createElement(u.ZP,{item:!0,container:!0,xs:12,justifyContent:"center",sx:{marginTop:5},s:!0},n.createElement(h.Z,{variant:"contained",sx:{width:400,height:120},color:this.state.color,loading:this.state.logging,disabled:this.state.calling||null!==this.state.naoRegistraReason||0!==this.state.lockedSeconds||!this.state.isAuth,onClick:this.registrarPonto},this.state.isAuth?null!=this.state.naoRegistraReason?n.createElement(d.Z,{justifyContent:"center",alignItems:"center",gap:1},n.createElement(P.Z,{sx:{fontSize:60}})," ",this.state.naoRegistraReason):null==this.state.lockedSeconds?n.createElement(l.Z,{color:"inherit"}):0==this.state.lockedSeconds?n.createElement(y.Z,{sx:{fontSize:60}}):n.createElement(d.Z,{justifyContent:"center",alignItems:"center",gap:1},n.createElement(P.Z,{sx:{fontSize:60}})," ","Aguarde ".concat(this.state.lockedSeconds," segundos...")):n.createElement(d.Z,{justifyContent:"center",alignItems:"center",gap:1},n.createElement(P.Z,{sx:{fontSize:60}}),"Dispositivo não autorizado!"))),null!==this.props.usuario&&this.props.usuario.permissaoList.includes("Ponto.Write.All")?n.createElement(u.ZP,{item:!0,container:!0,xs:12,justifyContent:"center",sx:{marginTop:5},s:!0},n.createElement(h.Z,{variant:"contained",size:"large",loading:this.state.authenticating,startIcon:this.state.isAuth?n.createElement(P.Z,null):n.createElement(Z.Z,null),loadingPosition:"start",color:this.state.isAuth?"error":"success",disabled:this.state.authenticating,onClick:this.handleAuthenticate},this.state.isAuth?"Desautorizar Dispositivo":"Autorizar Dispositivo")):"")),n.createElement(c.Z,{in:this.state.alertOpen},this.state.alert)))}}])&&x(e.prototype,o),Object.defineProperty(e,"prototype",{writable:!1}),F}(n.Component);const F=function(t){var e=(0,k.UO)(),o=(0,k.TH)();return n.createElement(z,j({params:e,location:o},t))}},7638:(t,e,o)=>{o.d(e,{$D:()=>n,LP:()=>r,gy:()=>a,o4:()=>i});var n=function(){return null!=window.localStorage.getItem("ponto-token")},r=function(){return n()?window.localStorage.getItem("ponto-token"):""},i=function(t){window.localStorage.setItem("ponto-token",t)},a=function(){window.localStorage.removeItem("ponto-token")}}}]);